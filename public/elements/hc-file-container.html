<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="hc-file-displayer.html"/>
<dom-module id="hc-file-container">

<style>
	#container{
		background-color: #4d4d4d;
	}
	.wrapper{
		position:absolute;
		transition: all 2s;
	}
	
</style>

	<template>
	<div id="container">
	<!-- <hc-file-displayer height width></hc-file-displayer>
	<hc-file-displayer height width></hc-file-displayer> -->
	</div>
	<input type="button" value="move-stuff" id="presentation"/>

		
	</template>

	<script src="../js/Sprite3D.js" type="text/javascript"></script>
	<script>
	(function () {
    'use strict';
    Polymer({
      is: 'hc-file-container',
      properties: {
        height:{
          type: Number,
          value:500,
          notify:true
        },
        width:{
          type: Number,
          value:500,
          notify:true
        },
        id:{
          type:String,
          notify:true
        },
        data:{
        	type:Object,
        	value:{
        		name:"placeholder",
        		relations:[
        		{name:"pl1", code:"more code"},
        		{name:"pl2", code:"even more code"} 
        		],
        		source:"some code"
        	}
        },
        files:{
        	type: Array,
        },
        stage:{},

      },
      

      ready:function(){
      	this.width=window.innerWidth-30
      	this.height=window.innerHeight-30
        this.$.container.style.width= this.width+"px" //this.width+"px"
        this.$.container.style.height= this.height+"px"//this.height+"px"
        this.stage = Sprite3D.stage(this.$.container);
        // let mainFile = document.createElement("hc-file-displayer");
        // mainFile.setAttribute("width",400);
        // mainFile.setAttribute("height",300);
        // let x=this.stage.appendChild(Sprite3D.create(mainFile))
        // x.position(500,500).update()
        
        this.setUp();


      },
      setUp:function(){

       let files=[]
       files.push(this.createFileDisplayer(40,90, 50,50, true)) //main
       files.push(this.createFileDisplayer(20,70, 15,50))
       files.push(this.createFileDisplayer(20,70, 85,50))
       this.files=files
       this.$.presentation.onclick=function(){
       	// files[0].rotate(0,40,0).update()
       	window.setInterval(function(){
       		files.forEach(function(item){
       			item.rotate(0,2,0).update()
       		})
       		files[1].move(0,4,0)
       	}, 50)
       }
      },
      // everythin in percentages according of this.height and this.width
      createFileDisplayer(width, height, x, y, active){
      	let percX=this.width/100
      	let percY=this.height/100
      	// let element = document.createElement("hc-file-displayer");
      	let element = document.createElement("div")
      	element.style.width=percX*width+"px";
      	element.style.height=percX*height+"px";
      	element.style.position="absolute"
      	element.className="wrapper"
      	element.style.transition="all 2s"

      	let innerElement = document.createElement("hc-file-displayer");
      	innerElement.setAttribute("width",percX*width);
        innerElement.setAttribute("height",percY*height);
        if(active){
        	innerElement.setAttribute("is-editable",true);
        }
        element.appendChild(innerElement)
        let sprite = this.stage.appendChild(Sprite3D.create(element));
        sprite.position(percX*x-innerElement.width/2, percY*y-innerElement.height/2).update();

       
        return sprite;
      }

    });
})();

	</script>

</dom-module>